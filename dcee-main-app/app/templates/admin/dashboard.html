<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Riho admin is super flexible, powerful, clean &amp; modern responsive bootstrap 5 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, Riho admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="pixelstrap">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/x-icon">
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/x-icon">
    <title>DCEE</title>
    <!-- Google font-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;600;700;800&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/font-awesome.css') }}">
    <!-- ico-font-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/icofont.css') }}">
    <!-- Themify icon-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/themify.css') }}">
    <!-- Flag icon-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/flag-icon.css') }}">
    <!-- Feather icon-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/feather-icon.css') }}">
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/slick.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/slick-theme.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/scrollbar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/animate.css') }}">
    <!-- Plugins css Ends-->
    <!-- Bootstrap css-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/vendors/bootstrap.css') }}">
    <!-- App css-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    <link id="color" rel="stylesheet" href="{{ url_for('static', filename='css/color-1.css') }}" media="screen">
    <!-- Responsive css-->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/responsive.css') }}">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  </head>
  <body> 
    <!-- loader starts-->
    <div class="loader-wrapper">
      <div class="loader"> 
        <div class="loader4"></div>
      </div>
    </div>
    <!-- loader ends-->
    <!-- tap on top starts-->
    <div class="tap-top"><i data-feather="chevrons-up"></i></div>
    <!-- tap on tap ends-->
    <!-- page-wrapper Start-->
    <div class="page-wrapper compact-wrapper" id="pageWrapper">
      <!-- Page Header Start-->
      <div class="page-header">
        <div class="header-wrapper row m-0">
          <form class="form-inline search-full col" action="#" method="get">
            <div class="form-group w-100">
              <div class="Typeahead Typeahead--twitterUsers">
                <div class="u-posRelative"> 
                  <input class="demo-input Typeahead-input form-control-plaintext w-100" type="text" placeholder="Search Riho .." name="q" title="" autofocus="">
                  <div class="spinner-border Typeahead-spinner" role="status"><span class="sr-only">Loading... </span></div><i class="close-search" data-feather="x"></i>
                </div>
                <div class="Typeahead-menu"> </div>
              </div>
            </div>
          </form>
          <div class="header-logo-wrapper col-auto p-0">  
            <div class="logo-wrapper"> <a href="{{ url_for('admin.dashboard') }}"><img class="img-fluid for-light" src="{{ url_for('static', filename='images/logo/logo_dark.png') }}" alt="logo-light"><img class="img-fluid for-dark" src="{{ url_for('static', filename='images/logo/logo.png') }}" alt="logo-dark"></a></div>
            <div class="toggle-sidebar"> <i class="status_toggle middle sidebar-toggle" data-feather="align-center"></i></div>
          </div>
          <div class="left-header col-xxl-5 col-xl-6 col-lg-5 col-md-4 col-sm-3 p-0">
            <div> <a class="toggle-sidebar" href="#"> <i class="iconly-Category icli"> </i></a>
              <div class="d-flex align-items-center gap-2 ">
                <h4 class="f-w-600">Welcome Admin</h4><img class="mt-0" src="{{ url_for('static', filename='images/hand.gif') }}" alt="hand-gif">
              </div>
            </div>
            <div class="welcome-content d-xl-block d-none"><span class="text-truncate col-12">Here's what's happening with your store today. </span></div>
          </div>
          <div class="nav-right col-xxl-7 col-xl-6 col-md-7 col-8 pull-right right-header p-0 ms-auto">
            <ul class="nav-menus"> 
              <li class="d-md-block d-none"> 
                <div class="form search-form mb-0">
                  <div class="input-group"><span class="input-icon">
                      <svg>
                        <use href="{{ url_for('static', filename='svg/icon-sprite.svg#search-header') }}"></use>
                      </svg>
                      <input class="w-100" type="search" placeholder="Search"></span></div>
                </div>
              </li>
              <li class="d-md-none d-block"> 
                <div class="form search-form mb-0">
                  <div class="input-group"> <span class="input-show"> 
                      <svg id="searchIcon">
                        <use href="{{ url_for('static', filename='svg/icon-sprite.svg#search-header') }}"></use>
                      </svg>
                      <div id="searchInput">
                        <input type="search" placeholder="Search">
                      </div></span></div>
                </div>
              </li>
              <li class="onhover-dropdown">
                <svg>
                  <use href="{{ url_for('static', filename='svg/icon-sprite.svg#star') }}"></use>
                </svg>
               <li>
                <div class="mode"><i class="moon" data-feather="moon"> </i></div>
              </li>
              
              <li class="profile-nav onhover-dropdown"> 
                <div class="media profile-media"><img class="b-r-10" src="" alt="">
                  <div class="media-body d-xxl-block d-none">
                    <div class="d-flex align-items-center gap-2"> <span>ADMIN </span><i class="middle fa fa-angle-down"> </i></div>
                    <p class="mb-0 font-roboto">Admin</p>
                  </div>
                </div>
                <ul class="profile-dropdown onhover-show-div">
                  <li><a href="#" id="myProfileLink"><i data-feather="user"></i><span>My Profile</span></a></li>
                  <li><a href="letter-box.html"><i data-feather="mail"></i><span>Inbox</span></a></li>
                  <li> <a href="edit-profile.html"> <i data-feather="settings"></i><span>Settings</span></a></li>
                  <li><a class="btn btn-pill btn-outline-primary btn-sm" href="{{ url_for('auth.logout') }}">Log Out</a></li>
                </ul>
              </li>
            </ul>
          </div>
          <script class="result-template" type="text/x-handlebars-template">
            <div class="ProfileCard u-cf">                        
            <div class="ProfileCard-avatar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-airplay m-0"><path d="M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"></path><polygon points="12 15 17 21 7 21 12 15"></polygon></svg></div>
            <div class="ProfileCard-details"> 
            <div class="ProfileCard-realName">{{name}}</div>
            </div> 
            </div>
          </script>
          <script class="empty-template" type="text/x-handlebars-template"><div class="EmptyMessage">Your search turned up 0 results. This most likely means the backend is down, yikes!</div></script>
        </div>
      </div>
      <!-- Page Header Ends                              -->
      <!-- Page Body Start-->
      <div class="page-body-wrapper">
        <!-- Page Sidebar Start-->
        <div class="sidebar-wrapper" data-layout="stroke-svg">
          <div class="logo-wrapper"><a href="{{ url_for('admin.dashboard') }}"><img class="img-fluid" src="{{ url_for('static', filename='images/logo/1.png') }}" alt=""></a>
            <div class="back-btn"><i class="fa fa-angle-left"> </i></div>
            <div class="toggle-sidebar"><i class="status_toggle middle sidebar-toggle" data-feather="grid"> </i></div>
          </div>
          <div class="logo-icon-wrapper"><a href="{{ url_for('admin.dashboard') }}"><img class="img-fluid" src="{{ url_for('static', filename='images/logo/1.png') }}" alt=""></a></div>
          <nav class="sidebar-main">
            <div class="left-arrow" id="left-arrow"><i data-feather="arrow-left"></i></div>
            <div id="sidebar-menu">
              <ul class="sidebar-links" id="simple-bar">
                <li class="back-btn"><a href="{{ url_for('admin.dashboard') }}"><img class="img-fluid" src="{{ url_for('static', filename='images/logo/1.png') }}" alt=""></a>
                  <div class="mobile-back text-end"> <span>Back </span><i class="fa fa-angle-right ps-2" aria-hidden="true"></i></div>
                </li>
                <li class="pin-title sidebar-main-title">
                  <div> 
                    <h6>Pinned</h6>
                  </div>
                </li>
                <li class="sidebar-main-title">
                  <div>
                    <h6 class="lan-1">Auth</h6>
                  </div>
                </li>
                <li class="sidebar-list"><i class="fa fa-thumb-tack"> </i><a class="sidebar-link sidebar-title" href="#">
                  <svg class="stroke-icon">
                    <use href="{{ url_for('static', filename='svg/icon-sprite.svg#stroke-home') }}"></use>
                  </svg>
                  <svg class="fill-icon">
                    <use href="{{ url_for('static', filename='svg/icon-sprite.svg#fill-home') }}"></use>
                  </svg><span class="lan-3">Users</span></a>
                  <ul class="sidebar-submenu">
                    <li><a href="#" data-bs-toggle="modal" data-bs-target="#customerModal">Customer</a></li>
                    <li><a href="#" data-bs-toggle="modal" data-bs-target="#storefrontModal">StoreFront Owner</a></li>
                  </ul>
                </li>
                
                
                <li class="sidebar-main-title">
                  <div>
                    <h6 class="lan-8">Applications</h6>
                  </div>
                </li>
                <li class="sidebar-list"><i class="fa fa-thumb-tack"></i><a class="sidebar-link sidebar-title" href="#">
                    <svg class="stroke-icon">
                      <use href="{{ url_for('static', filename='svg/icon-sprite.svg#stroke-project') }}"></use>
                    </svg>
                    <svg class="fill-icon">
                      <use href="{{ url_for('static', filename='svg/icon-sprite.svg#fill-project') }}"></use>
                    </svg><span>Marketplace</span></a>
                  <ul class="sidebar-submenu">
                    <li><a href="#" data-bs-toggle="modal" data-bs-target="#storesModal">Stores</a></li>
                    <li><a href="#" data-bs-toggle="modal" data-bs-target="#productsModal">Products</a></li>
                  </ul>
                </li>
                
                  <li class="sidebar-main-title">
                        <div class="right-arrow" id="right-arrow"><i data-feather="arrow-right"></i></div>
                        </div>
                        </nav>
                        </div>
                        <!-- Page Sidebar Ends-->
                        <div class="page-body">
                          <div class="container-fluid">
                            <div class="page-title">
                              <div class="row">
                                <div class="col-6">
                                  <h4>Dashboard</h4>
                                </div>
                                
                              </div>
                            </div>
                          </div>
                          <!-- Container-fluid starts-->
                          <div class="container-fluid">
                            <div class="row">
                              <!-- Statistics Cards -->
                              <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card border-left-primary shadow h-100 py-2">
                                  <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Total Store Owners</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_store_owners }}</div>
                                      </div>
                                      <div class="col-auto">
                                        <i class="fas fa-store fa-2x text-gray-300"></i>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card border-left-success shadow h-100 py-2">
                                  <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Total Products</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_products }}</div>
                                      </div>
                                      <div class="col-auto">
                                        <i class="fas fa-box fa-2x text-gray-300"></i>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card border-left-info shadow h-100 py-2">
                                  <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Customers</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_customers }}</div>
                                      </div>
                                      <div class="col-auto">
                                        <i class="fas fa-users fa-2x text-gray-300"></i>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card border-left-warning shadow h-100 py-2">
                                  <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                      <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Total Orders</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_orders }}</div>
                                      </div>
                                      <div class="col-auto">
                                        <i class="fas fa-shopping-cart fa-2x text-gray-300"></i>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!-- Graph -->
                            <div class="row">
                              <div class="col-xl-8 col-lg-7">
                                <div class="card shadow mb-4">
                                  <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Monthly Sales Overview</h6>
                                  </div>
                                  <div class="card-body">
                                    <div class="chart-area">
                                      <canvas id="myAreaChart"></canvas>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <!-- Pie Chart -->
                              <div class="col-xl-4 col-lg-5">
                                <div class="card shadow mb-4">
                                  <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Product Categories</h6>
                                  </div>
                                  <div class="card-body">
                                    <div class="chart-pie pt-4 pb-2">
                                      <canvas id="myPieChart"></canvas>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <!-- Original content -->
                            <div class="row">
                              <div class="col-sm-12">
                                <div class="card">
                                  <div class="card-header">
                                    <h4>ADMIN DASHBOARD</h4><span>As the admin of the Digital Commerce Empowerment Ecosystem (DCEE), you have full access to manage and oversee all aspects of the platform. Your role is crucial in ensuring the smooth operation and growth of our digital commerce community. Thank you for your dedication and leadership.
                                    </span>
                                  </div>
                                  <div class="card-body">
                                    <p>excited to achieve great success!</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- Container-fluid Ends-->
                        </div>
                        <!-- footer start-->
                        <footer class="footer">
                          <div class="container-fluid">
                            <div class="row">
                              <div class="col-md-12 footer-copyright text-center">
                                <p class="mb-0">Copyright 2024 © DCEE   </p>
                              </div>
                            </div>
                          </div>
                        </footer>
                        </div>
                        </div>
                        <!-- latest jquery-->
<script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
<!-- Bootstrap js-->
<script src="{{ url_for('static', filename='js/bootstrap/bootstrap.bundle.min.js') }}"></script>
<!-- feather icon js-->
<script src="{{ url_for('static', filename='js/icons/feather-icon/feather.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/icons/feather-icon/feather-icon.js') }}"></script>
<!-- scrollbar js-->
<script src="{{ url_for('static', filename='js/scrollbar/simplebar.js') }}"></script>
<script src="{{ url_for('static', filename='js/scrollbar/custom.js') }}"></script>
<!-- Sidebar jquery-->
<script src="{{ url_for('static', filename='js/config.js') }}"></script>
<!-- Plugins JS start-->
<script src="{{ url_for('static', filename='js/sidebar-menu.js') }}"></script>
<script src="{{ url_for('static', filename='js/sidebar-pin.js') }}"></script>
<script src="{{ url_for('static', filename='js/slick/slick.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/slick/slick.js') }}"></script>
<script src="{{ url_for('static', filename='js/header-slick.js') }}"></script>
<!-- calendar js-->
<!-- Plugins JS Ends-->
<!-- Theme js-->
<script src="{{ url_for('static', filename='js/script.js') }}"></script>

<!-- customer Modals -->
<div class="modal fade customerModal" id="customerModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><b>Customer Details</b></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container mt-5">
          <h2>Customer Details</h2>
          <table id="customerTable" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Created At</th>
                <th>Email</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Updated At</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data will be populated here by DataTables -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- End customer modal -->

<!-- Storefront Owner modal -->
<div class="modal fade" id="storefrontModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><b>Storefront Owner Details</b></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container mt-5">
          <h2>Storefront Owner Details</h2>
          <table id="storefrontTable" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Created At</th>
                <th>Email</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>GSTIN</th>
                <th>Updated At</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data will be populated here by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- End storefront owner modal -->

<!-- Stores Modal -->
<div class="modal fade" id="storesModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><b>Registered Stores</b></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container mt-5">
          <table id="storesTable" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Store Name</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data will be populated here by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Products Modal -->
<div class="modal fade" id="productsModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"><b>Registered Products</b></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container mt-5">
          <table id="productsTable" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Product Name</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data will be populated here by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Admin Profile Modal -->
<div class="modal fade" id="adminProfileModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Admin Profile</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p><strong>First Name:</strong> <span id="adminFirstName"></span></p>
        <p><strong>Last Name:</strong> <span id="adminLastName"></span></p>
        <p><strong>Email:</strong> <span id="adminEmail"></span></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
</body>
<!-- DataTables JS -->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>

<!-- Customer modal JS -->
<script>
$(document).ready(function() {
  $('#customerModal').on('shown.bs.modal', function() {
    if (!$.fn.DataTable.isDataTable('#customerTable')) {
      $('#customerTable').DataTable({
        "ajax": {
          "url": "{{ url_for('admin.get_customers') }}",
          "dataSrc": ""
        },
        "columns": [
          { "data": "created_at" },
          { "data": "email" },
          { "data": "first_name" },
          { "data": "last_name" },
          { "data": "updated_at" },
          {
            "data": null,
            "render": function(data, type, row) {
              return '<button class="btn btn-danger btn-sm deactivate-customer" data-id="' + row._id + '">Deactivate</button>';
            }
          }
        ]
      });
    }
  });

  // Deactivate customer
  $('#customerTable').on('click', '.deactivate-customer', function() {
    var table = $('#customerTable').DataTable();
    var tr = $(this).closest('tr');
    var row = table.row(tr);
    
    // Visually remove the row
    row.remove().draw(false);
  });
});
</script>

<!-- End customer modal -->

<!-- StoreFront owner JS -->
<script>
$(document).ready(function() {
  $('#storefrontModal').on('shown.bs.modal', function() {
    if (!$.fn.DataTable.isDataTable('#storefrontTable')) {
      $('#storefrontTable').DataTable({
        "ajax": {
          "url": "{{ url_for('admin.get_storefrontowners') }}",
          "dataSrc": ""
        },
        "columns": [
          { "data": "createdAt" },
          { "data": "email" },
          { "data": "first_name" },
          { "data": "last_name" },
          { "data": "gstin" },
          { "data": "updatedAt" },
          {
            "data": null,
            "render": function(data, type, row) {
              return '<button class="btn btn-danger btn-sm deactivate-storefront" data-id="' + row._id + '">Deactivate</button>';
            }
          }
        ]
      });
    }
  });

  // Deactivate storefront owner
  $('#storefrontTable').on('click', '.deactivate-storefront', function() {
    var table = $('#storefrontTable').DataTable();
    var tr = $(this).closest('tr');
    var row = table.row(tr);
    
    // Visually remove the row
    row.remove().draw(false);
  });
});
</script>
<!-- end storefront owner modal JS -->

<!-- Add DataTables initialization for Stores and Products -->
<script>
$(document).ready(function() {
  $('#storesModal').on('shown.bs.modal', function() {
    if (!$.fn.DataTable.isDataTable('#storesTable')) {
      $('#storesTable').DataTable({
        "ajax": {
          "url": "{{ url_for('admin.get_stores') }}",
          "dataSrc": ""
        },
        "columns": [
          { "data": "store_name" }
        ]
      });
    }
  });

  $('#productsModal').on('shown.bs.modal', function() {
    if (!$.fn.DataTable.isDataTable('#productsTable')) {
      $('#productsTable').DataTable({
        "ajax": {
          "url": "{{ url_for('admin.get_products') }}",
          "dataSrc": ""
        },
        "columns": [
          { "data": "product_name" }
        ]
      });
    }
  });
});
</script>

<!-- Add Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Add charts initialization -->
<script>
  // Area Chart
  var ctx = document.getElementById("myAreaChart");
  var myLineChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      datasets: [{
        label: "Sales",
        lineTension: 0.3,
        backgroundColor: "rgba(78, 115, 223, 0.05)",
        borderColor: "rgba(78, 115, 223, 1)",
        pointRadius: 3,
        pointBackgroundColor: "rgba(78, 115, 223, 1)",
        pointBorderColor: "rgba(78, 115, 223, 1)",
        pointHoverRadius: 3,
        pointHoverBackgroundColor: "rgba(78, 115, 223, 1)",
        pointHoverBorderColor: "rgba(78, 115, 223, 1)",
        pointHitRadius: 10,
        pointBorderWidth: 2,
        data: [0, 10000, 5000, 15000, 10000, 20000, 15000, 25000, 20000, 30000, 25000, 40000],
      }],
    },
    options: {
      maintainAspectRatio: false,
      layout: {
        padding: {
          left: 10,
          right: 25,
          top: 25,
          bottom: 0
        }
      },
      scales: {
        xAxes: [{
          time: {
            unit: 'date'
          },
          gridLines: {
            display: false,
            drawBorder: false
          },
          ticks: {
            maxTicksLimit: 7
          }
        }],
        yAxes: [{
          ticks: {
            maxTicksLimit: 5,
            padding: 10,
            // Include a dollar sign in the ticks
            callback: function(value, index, values) {
              return '$' + number_format(value);
            }
          },
          gridLines: {
            color: "rgb(234, 236, 244)",
            zeroLineColor: "rgb(234, 236, 244)",
            drawBorder: false,
            borderDash: [2],
            zeroLineBorderDash: [2]
          }
        }],
      },
      legend: {
        display: false
      },
      tooltips: {
        backgroundColor: "rgb(255,255,255)",
        bodyFontColor: "#858796",
        titleMarginBottom: 10,
        titleFontColor: '#6e707e',
        titleFontSize: 14,
        borderColor: '#dddfeb',
        borderWidth: 1,
        xPadding: 15,
        yPadding: 15,
        displayColors: false,
        intersect: false,
        mode: 'index',
        caretPadding: 10,
        callbacks: {
          label: function(tooltipItem, chart) {
            var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
            return datasetLabel + ': $' + number_format(tooltipItem.yLabel);
          }
        }
      }
    }
  });

  // Pie Chart
  var ctx = document.getElementById("myPieChart");
  var myPieChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ["Electronics", "Clothing", "Books", "Home & Garden"],
      datasets: [{
        data: [40, 30, 15, 15],
        backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc', '#f6c23e'],
        hoverBackgroundColor: ['#2e59d9', '#17a673', '#2c9faf', '#f4b619'],
        hoverBorderColor: "rgba(234, 236, 244, 1)",
      }],
    },
    options: {
      maintainAspectRatio: false,
      tooltips: {
        backgroundColor: "rgb(255,255,255)",
        bodyFontColor: "#858796",
        borderColor: '#dddfeb',
        borderWidth: 1,
        xPadding: 15,
        yPadding: 15,
        displayColors: false,
        caretPadding: 10,
      },
      legend: {
        display: false
      },
      cutoutPercentage: 80,
    },
  });

  function number_format(number, decimals, dec_point, thousands_sep) {
    // ... (implement number formatting function)
  }
</script>

<script>
$(document).ready(function() {
  console.log("Document ready");

  $('#myProfileLink').on('click', function(e) {
    console.log("My Profile link clicked");
    e.preventDefault();
    
    // Try to show the modal immediately (for testing)
    $('#adminProfileModal').modal('show');
    
    // Fetch admin profile data
    $.ajax({
      url: "{{ url_for('admin.get_admin_profile') }}",
      method: "GET",
      success: function(response) {
        console.log("Admin profile data:", response);
        $('#adminFirstName').text(response.first_name);
        $('#adminLastName').text(response.last_name);
        $('#adminEmail').text(response.email);
        
        // Show the modal
        $('#adminProfileModal').modal('show');
      },
      error: function(xhr, status, error) {
        console.error("Failed to fetch admin profile. Status:", status);
        console.error("Error:", error);
        console.error("Response:", xhr.responseText);
        alert("Failed to fetch admin profile. Please try again.");
      }
    });
  });
});
</script>
</html>